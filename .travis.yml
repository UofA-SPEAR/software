#TODO: install ROS

git:
  submodules: false

matrix:
  include:
    - name: "python linting"
      language: python
      python: 3.5
      before_script:
        - sudo apt-get update
        - sudo apt-get install pep8
      script:
        - pep8 --ignore=E501 . --exclude='spear_behaviors/spear_flexbe_behaviors/src/**'

    - name: "c++ linting"
      language: c++
      compiler: gcc
      before_script:
        - sudo apt-get update
        - sudo apt-get install clang-format-3.9
      script:
        - "! find . -iname '*.h' -o -iname '*.cpp' |
          xargs clang-format-3.9 -output-replacements-xml -style=Google |
          grep -F \"</replacement>\""

    - name: "javascript linting"
      before_script:
        - sudo apt-get update
        - curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.1/install.sh | bash
        - nvm install 12.13
      script:
        - cd linting
        - bash javascript.sh

    - name: "xml linting"
      before_script:
        - sudo apt-get update
        - sudo apt-get install libxml2-utils
      script:
        - bash xml_lint.bash

    - name: "build"
      services:
        - docker
      before_script:
        - docker pull ros:kinetic-robot
      script:
        - docker-compose build
        - docker run spear bash /software/catkin_lint.bash

notifications:
  email: false
